## 服务器

[linux服务器](readings/linux服务器.md)将Milvus数据库部署在服务器里。

-- conda环境[直接用]

-- -- 项目

-- -- -- docker相关文件

## 项目流程

1. 第一阶段：(最小可执行化Rag) （1-3周)
   - 基于Milvus构建简约Rag知识问答。
   - mysql用以管理历史对话记录。
   - fastapi启动接口服务
   - ragas评估
2. 第二阶段：优化向量检索 (1-3周)
   - 加入稀疏稠密混合向量检索
   - 加入重排序
   - 加入父子模式
3. 第三阶段：优化检索策略(2-4周)
   - 加入回溯，子查询分解，假设问题等检索策略
   - 微调意图识别模型，分类特定问题，通用问题与闲聊
4. 第四阶段：加入对FQA的回答系统 (1-3周)
   - 利用Mysql,Redis与bm25搜索技术建立对FQA的问答系统
   - 与Milvus的rag系统融合
5. 第五阶段：后优化与持续评估 （项目没做到这步)
   - 记忆管理优化（长短期记忆)  （1-2周）
     - redis负责短期记忆搜索(按照时间排序取前k个聊天记录)
     - mivlus负责长期记忆搜索(按照向量搜索查询n个与当前query相似的聊天记录)
     - mysql备份全部聊天记录
   - 微调分类回溯，子查询，假设问题等的分类模型 （2-5周）
   - 分别微调回溯，子查询，假设问题等的生成式模型 ( 8周打底 )
     - 这指的是例如 生成式模型生成出 回溯问题，取代LLM生成。
   - 其他 ( 持续 )

## 项目结构

```
rag_project/
├── base/                           # 基础配置模块
│   ├── _gen_config.py             # 配置生成脚本
│   ├── config.ini                 # 配置文件
│   ├── config_gen.py              # 配置生成器
│   ├── config_parser.py           # 配置解析器
│   └── configs.py                 # 配置管理类
├── conn/                          # 连接管理模块
│   ├── llms.py                    # 大语言模型连接
│   ├── milvus_conn.py             # Milvus向量数据库连接
│   ├── mysql_conn.py              # MySQL数据库连接
│   ├── redis_conn.py              # Redis缓存连接
│   └── rerank_conn.py             # 重排序模型连接
├── datas/                         # 数据和模型目录
│   ├── models/                    # 模型文件（各种预训练模型）
│   ├── rerords/                   # 记录文件
│   ├── download_model.py          # 模型下载脚本
│   └── filepaths.py               # 文件路径管理
├── env/                           # 环境配置模块
│   ├── deepseek_envs.py           # DeepSeek API环境配置
│   ├── langsmith_env.py           # LangSmith环境配置
│   ├── serect.py                  # 密钥配置
│   └── silicon_envs.py            # Silicon API环境配置
├── frontend/                      # 前端页面
│   └── chat.html                  # 聊天界面
├── managers/                      # 管理器模块
│   ├── mysql_manager.py           # MySQL管理器
│   ├── redis_manager.py           # Redis管理器
│   └── vector_store.py            # 向量存储管理器
├── offline/                       # 离线处理模块
│   ├── fine_tune_query_clissifier/gen_datas/  # 查询分类器微调数据生成
│   │   ├── agents/                # 智能体模块
│   │   │   ├── chat_message_agent.py         # 聊天消息代理
│   │   │   ├── check_general_knowledge_agent.py  # 通用知识检查代理
│   │   │   ├── general_knowledge_agent.py    # 通用知识代理
│   │   │   └── specific_knowledge_agent.py   # 专业知识代理
│   │   ├── my_tools/              # 自定义工具
│   │   │   ├── draw_graph.py      # 图形绘制工具
│   │   │   └── read_chunks.py     # 文档片段读取工具
│   │   ├── config.py              # 配置文件
│   │   ├── gen_data_workflow.py   # 数据生成工作流
│   │   ├── graph.html             # 图形展示页面
│   │   ├── total_datas.json       # 总数据文件
│   │   └── 统计一下.py             # 数据统计脚本
│   ├── insert2milvus/             # Milvus数据插入
│   │   ├── doc_process.py         # 文档处理
│   │   └── insert2milvus.py       # 数据插入Milvus
│   ├── insert2mysql/              # MySQL数据插入
│   │   └── insert2mysql.py        # 数据插入MySQL
│   └── rages_evaluation/          # RAG系统评估
│       ├── datas/                 # 评估数据
│       ├── reports/               # 评估报告
│       ├── evaluate.py            # 评估脚本
│       └── gen_data.py            # 数据生成脚本
├── online/                        # 在线服务模块
│   ├── mysql_search/              # MySQL搜索
│   │   └── bm25_search.py         # BM25搜索算法
│   ├── rag_system/                # RAG系统核心
│   │   ├── prompts.py             # 提示词模板
│   │   ├── query_classifier.py    # 查询分类器
│   │   ├── rag_system_final.py    # RAG系统最终版本
│   │   ├── rag_system_simple.py   # RAG系统简化版本
│   │   ├── rag_system_with_strategy_selector.py  # 带策略选择器的RAG系统
│   │   └── strategy_selector.py   # 策略选择器
│   └── major.py                   # 主要入口文件
├── study/                         # 学习示例模块
├── utils/                         # 工具模块
│   ├── agent_util/                # 智能体工具
│   │   └── gen_frontend_from_fastapi.py  # 从FastAPI生成前端
│   ├── doc_utils/                 # 文档工具
│   │   ├── extra/doc_process/     # 额外文档处理
│   │   │   ├── doc_loaders/       # 文档加载器
│   │   │   │   ├── edu_docloader.py      # 文档加载器
│   │   │   │   ├── edu_imgloader.py      # 图片加载器
│   │   │   │   ├── edu_ocr.py            # OCR工具
│   │   │   │   ├── edu_pdfloader.py      # PDF加载器
│   │   │   │   └── edu_pptloader.py      # PPT加载器
│   │   │   ├── text_splitters/    # 文本分割器
│   │   │   │   ├── edu_chinese_recursive_text_splitter.py  # 中文递归分割器
│   │   │   │   └── edu_model_text_spliter.py               # 模型文本分割器
│   │   │   └── document_loader.py # 文档加载器
│   │   ├── doc_reader_utils.py    # 文档读取工具
│   │   └── text_splitters_utils.py # 文本分割工具
│   └── general_utils/             # 通用工具
│       ├── globle_util.py         # 全局工具
│       ├── loggers.py             # 日志工具
│       ├── prase_json.py          # JSON解析工具
│       └── time_util.py           # 时间工具
├── app.py                         # 主应用入口
└── requirement.txt                # 项目依赖
```



# JSON

JSON 是存储和交换文本信息的语法。JSON 语法是 JavaScript 对象表示语法的子集。

- 数据在名称/值对中
- 数据由逗号 , 分隔
- 使用斜杆 \ 来转义字符
- 大括号 {} 保存对象
- 中括号 [] 保存数组，数组可以包含多个对象