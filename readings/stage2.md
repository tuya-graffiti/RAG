# 稠密稀疏混合向量检索



# 重排序



# 父子模式

子块用于检索，父块用于上下文。优势在于解耦检索精度与输出内容全面性。

![](E:\xun\Project\ai\项目\RAG\代码\rag_myself\readings\pic\1754209549659.png)

### 构建思路

1. 在文档切段时先切父文档(可以设定tokens多一点)，再在每个父文档的基础上切子文档。

2. 存入向量库时，以子文档为单元存储，父文档内容作为子文档的标量属性存储. 

   > (注意这会冗余，实际工作时最好将父文档存在mysql，父文档索引作为子文档标量属性)

3. 检索时，先通过query混合检索出top k的子文档。关联初父文档后去重。

4. 对去重后的父文档rerank, 删选出最终的tok m的父文档输出。